---
title: 20200309_業界を変えた大規模サービスの技術選定
tags:
  - 勉強会メモ
  - 社内
  - 技術選定
private: true
updated_at: '2023-06-15T01:07:31+09:00'
id: 610bcabaded0c1143a0e
organization_url_name: null
---
## 業界を変えた大規模サービスの技術選定

```
「技術選定」の本質はどこにあるのでしょう？
流行っている技術？数年後も廃れる可能性が少ない技術？今の組織にあった手法？コストパフォーマンス？
それぞれの目的に応じた、その時最適だと思う技術選定をし続けながら、エンジニアの開発運用は続きます。

世の中に大きなインパクトを与えたサービスの技術選定はどんな意思決定を繰り返しているのか。
今回はそんな、私たちの生活に影響を与えた大規模サービスで技術選定をしている方たちお呼びして登壇形式でイベントを開催します。

技術選定は、ビジネスと組織の未来を考えることでもあります。一緒に未来を考えませんか？
```

## 大項目目次

1. [TL;DR](#tldr)
2. [メモ書き](#メモ書き)
    1. [マネーフォワード](#マネフォ資料共有あり-中出さん)
    2. [ラクスル](#ラクスル資料共有あり-二串さん)
    3. [ビズリーチ](#ビズリーチ資料共有なし-外山さん)
    4. [Q&A](#q--a)
3. [聞いての所感(駄文)](#聞いての所感駄文)

## TL;DR

- 技術選定は会社、サービスの特性を知ることから
- 技術選定、アーキテクチャの設計もあくまでHowであることを忘れない、Whyを考えること
- マネジメント層は経営層に対して、技術選定、それにかかるコストの説明責任をもつこと
- 各社の技術選定に関して
  - マネフォ
    - ビジネスモデル上ランニングコストを最低に抑えることを意識しての設計
    - 最速でできる技術、方法を意識し続けている
    - 今後は社内のエンジニアが変化がしやすい設計、仕組みを考え続ける
  - ラクスル
    - 自分たちのエンジニアを定義することで自分たちの行動に納得感をだす
    - 現戦力で成果を最大化させる技術構成、堅実 > 挑戦
    - エンジニアは他職種と一緒にプロダクトのビジョンを描いていく
  - ビズリーチ
    - 技術選定はあくまでHowの話、WhyとWhatを考えることで優先度をつけ、解決をしていく
    - 技術選定、リファクタリングなどを進めていくには経営層に対しての説明責任は出てくる

<a id="anchor2"></a>

## メモ書き

<a id="anchor2-1"></a>

## マネフォ(資料共有あり) 中出さん

### 技術の前提

- 20以上のプロダクト
- プロダクトカットで組織編成(チームごとに複数職)
- インフラは横串でみる
- プロダクトチームで利用技術、プロセス、アーキテクチャを選定
  - 現場が最適を知っているという考え
- 技術
  - バックエンド
    - Rails中心
      - 0→1で有効、開発の早い
      - 卜部さん、松田さんがいる安心感(Rubyコミッター)

### MEに関して

- サービスの特徴(選定の上でこれ知るの大事)
  - ユーザーデータのボリューム
    - ユーザーデータがアクセスログの類ではなく多い
    - データの増え方が二次関数
  - ユーザーをまたいでの利用データは少ない
    - キャッシュが効きにくい
  - ARPUが安い
    - ストック型のビジネスモデル
    - データ保持コストのコントロール
  - 負荷はほぼ一定でキャパシティープランニングは用意
- 技術の歩み
  - 最初はPHP、他がJava
    - インターンのエンジニアの推薦でRailsに変更
    - コンテナ(AWS) → さくらへ
      - 運用コスト
  - スピード重視で共有DBをME、クラウド会計で見る仕組み
    - ME専用DB、アグリゲーションのAPI、DBを作成
  - 課金、ユーザーなどごとにマイクロサービス化

### MEまとめ

- 生き残ることに対して必死
  - ランニングコストを最低限抑える
- 共有DBキャパシティの課題解消
- DB共有による密結合の解消
- 今後はEKSの以降検討

### 考え方

- 小さいエンジニア組織は技術を共有化
  - 効率化
- 組織が拡大したら増やしていける
  - 流行り廃りのリスクヘッジ
  - **変化に対しての許容する文化**
- マイクロサービスはやっていく
  - 設計難易度は高いが覚悟を決める
  - インフラをプロダクトチームへの管理に寄せる
  - 新しくチャレンジできる環境づくり
  - 開発環境の整備は頑張る
- インフラ
  - クラウドインフラは高い
  - ただし時勢的に仮想コンテナが当たり前になっている
  - 仮想化、コンテナ化前提の技術選定もあり

### マイクロサービスの事例共有

- 共有のライブラリをリプレイス
  - 境界線を決める手間はなし
  - ステートレスならシンプル
  - 開発環境の構築はマイクロサービスを起動するだけで
- jarでしか提供されていないライブラリを使いたい
- SSO基盤
- アグリゲーションデータの共有基盤
- サービスのロジックをマイクロサービスに切り出し

### メリット

- チームの分割ができる
- 保守性が高まる
- 新しくチャレンジすることの基盤づくり

<a id="anchor2-2"></a>

## ラクスル(資料共有あり) 二串さん

技術選定は会社を知ることから始めよ

### 技術

- バックエンドメインはRails(phpから以降)
- フロントはVue
- インフラはクラウド

### ラクスルにおける技術の意味付け

- 技術力の高いエンジニアがいてプロダクトを作っているだけでは他の会社と一緒くたになる
- **ラクスルはビジネス開発が非常に得意な会社である**
  - 伝統産業の課題に着目
  - 高い解決力
  - 技術会社ではない、技術は手段
  - **他社の真似だけではうまくいかない**

### コストパフォーマンス技術選定

- **現戦力で成果を最大化させる技術選定**
  - コストと成果量
  - 問題を複雑にしすぎない(KISSの法則)
    - 後からジョインした人が理解できるか?という観点
  - 事例
    - インフラ
      - EC2メイン
        - コンテナ化は実利が少なく本番での導入はしていない
        - マイクロサービスは整えていな
        - EC2ベースで今のフェーズは困っていない
    - サービスアーキテクチャ
      - オーバーエンジニアリング
      - 新たなconcernによる開発効率の低下の懸念
        - 単体テストのコスト
        - 開発環境の整備
        - インフラの何度
      - ドメイン分離型のモノリスアプリケーションを採用
        - 共通機能(認証、決済)は切り出してAPI
        - ユーザーに見えるサイト管理部分、はドメインごとにPJを作成
  - ラクスルのシステム刷新
    - 刷新の目的は経営戦略の選択肢が増えている状態にすること
      - 既存PHPモノリスそのものに問題
    - 技術的な飛躍は盛り込まない
      - 未習熟による不確実性、再負債になることの排除

### プロダクト中心の技術選定

- **制約の中でどういう戦略を取れるか**を考える
- 徹底的に現場の解像度をあげて、プロダクトビジョンを描く
  - 現場観察、ユーザーリサーチ
  - プロダクトビジョンの設定
  - アジャイルの導入
- エンジニアとしての役割に納得感を出して働くこと
-

### まとめ

- ラクスルは産業の課題をプロダクトで解決する会社
- エンジニアはパワーのかけ方を意識して事業成長を支える
- 事業特性を知ることはエンジニアとしてバリューを発揮するための近道

<a id="anchor2-3"></a>

## ビズリーチ(資料共有なし) 外山さん

### 事業の特徴

- プロダクト別でエンジニア
  - JVMが基本
- SRE、デザイン、QA、セキュリティが横軸

### 技術選定の難しさ

- 将来を見越した技術選定
  - 創業、マネタイズ、急成長、成熟のフェーズによる違い
- 事業に合わせた判断基準を定量的に
  - V1.0以上
  - スター数など
- 急成長、成熟期は難易度が上がる
  - ROI(費用対効果 / 投資対効果)
    - 利益 / 投資 * 100
    - 利益の証明ってどうすんの
  - そもそも技術選定をすべき理由を考える(Why - What - How)
    - EOL(セキュリティ)
    - フロント保守性(スピード向上)
    - 運用保守の関し対応(セキュリティ)
    - 新技術のキャッチアップ(新たな売り上げ)
  - その優先順位は？
    - Whyが解消された際の効果で優先度をつけることができる?
      - でも辛い(どれも大事だよね)
    - 事業に対しての貢献度
    - 組織、プロダクト、チーム、社風で異なる

### 成長し続けるための技術選定を行うための戦術

- 課題の可視化
  - 事象と課題、カテゴリを記入する
  - 定期的な棚卸し
  - **議論の認識咀嚼がへる**
- 課題の評価
  - 緊急性
  - リスク
  - 生産性
  - コストなど
- 解決方法の検討
  - **ボトムアップで提案できる仕組み**が理想
  - 最小コストかつ生産性の上がる方法
- 優先順位判断
  - 投資が長期になる程、効果の証明が困難、これが難しくする
    - 開発の20%を投資に当てる
    - チームによる責任範囲を分ける
      - 時間軸のみの基準になる
    - PL、生産性、組織の責任の役割を分ける
    - 判断基準を言語化、定量化
- プロダクト戦略の追加
- 経営層の理解

### 事例紹介

![スクリーンショット 2020-03-09 20.52.15.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166596/dac0f403-7f84-7231-8208-e00d6970ceaa.png)

![スクリーンショット 2020-03-09 20.52.43.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166596/5a7d25ee-940d-506e-ce48-4837f33d1a20.png)

![スクリーンショット 2020-03-09 20.53.08.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166596/b9bbfec4-9420-86cf-0d92-cd3152a10540.png)

### ビズリーチが投資する理由

- 運用が長くなることで生産性の減少、保守コストの増加
- 生産性を向上させるために、システムを成長、疎結合を行う
- 成長を続けてくためにはバランスが大事
  - 生産性や組織を軽視してPLを意識しがち
  - PLと生産性と組織を分けて役割を分担
- 非連続的成長を遂げるためにAI室を設置
  - 重要性高いが成果にまだ繋がりにくい

### まとめ

ビズリーチ使おう

<a id="anchor2-4"></a>

## Q & A

### To: マネーフォワード

- プロダクトチームに権限委譲することでの会社としてのハンドリングの難しさ
  - 難しく感じる実感ない、割と自由にやらせている
  - 突拍子もない言語選定などは今のところない
- 技術選定でマネジメント層の果たす役割
  - チャレンジングな技術に関して、全力で応援する

### To: ラクスル

- 後からジョインされるエンジニアにわかりやすくするための取り組み
  - オンボーディングに注力
    - ペアプロ、モブプロ
    - 短期的なベロシティの低下は許容
- 技術選定でマネジメント層の果たす役割
  - 負債に関しては現場の声を聞いて、他に対してきちんと説明する
  - エンジニア目線で一緒に考えてあげる

### To: ビズリーチ

- 後からジョインされるエンジニアにわかりやすくするための取り組み
  - 同じ月に入った人同士の事業部を跨いだ同期を形成
- 技術選定でマネジメント層の果たす役割
  - 経営に対しての説明責任
  - プロダクトの課題ではなく、組織課題であることの認識

<a id="anchor3"></a>

## 聞いての所感(駄文)

- マネフォ
  - プロダクト特性の理解
    - ハナユメ、ヒマリで考えるとどうなのだろうかというのを考えてみたい
    - それに対しての今の考えている構成は妥当なのだろうか
  - マイクロサービス切り出しの事例
    - ハナユメ、ヒマリの共通部分から切り出してAPI化していくのが検証しやすいしとっつきやすそう
- ラクスル
  - 考え方が似ているので内容が目から鱗
  - どうすれば早く確実にを意識して生産性を上げていく
  - エンジニアとしての成長(新しい技術の使用)は多くはなさそうだが、プロダクトを考えるという部分でエンジニアの価値を高めている
    - その中でエンジニアとして出来ること、バリュー提供を行なっている
  - うちにおける技術の意味付けはどうなんだろうか
  - うちで「エンジニアとして今楽しいですか?」と聞かれたら、誰がどう答えるんだろうか

- ビズリーチ
  - 技術課題の解決をWhy-What-Howで考えるのは積極的にやりたい
  - フォーマット化することで技術課題を比較して見える化
    - それを蓄積しておいて、定期的に棚卸する仕組みはエンジニアとしてもそうだし、プロダクトの成長にも繋がる
    - それをやっていくための経営層への説得、理解が必要
    - メルペイのようにOKRで設定するとか？
